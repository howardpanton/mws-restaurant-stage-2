"use strict";var _createClass=function(){function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var registerSW=function(){"serviceWorker"in navigator?navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Registration complete.")},function(){console.log("Registration failure.")}):console.log("Service worker not supported.")},updateStatus=function(e){var n=document.getElementById("status"),t=navigator.onLine?"online":"offline";"offline"===t?(console.log(t,"status"),n.className=t,n.insertAdjacentHTML("beforeend","Status: Website "+t),n.setAttribute("aria-live","assertive")):"online"===t&&(n.className="",n.innerHTML="",n.removeAttribute("aria-live"))};window.addEventListener("online",updateStatus),window.addEventListener("offline",updateStatus);var DBHelper=function(){function u(){_classCallCheck(this,u)}return _createClass(u,null,[{key:"fetchFromApi",value:function(n,e){var t=new Request(""+u.DATABASE_URL+e,{method:"GET",headers:new Headers({"Content-Type":"application/json"})});fetch(t).then(function(e){200===e.status?e.json().then(function(e){console.log(e),n(null,e)}):console.log("Looks like there was a problem. Status Code: "+e.status)}).catch(function(e){console.log("Fetch Error :-S",e),n("Request failed. Returned "+e,null)})}},{key:"fetchRestaurantById",value:function(o,r){u.fetchRestaurants(function(e,n){if(e)r(e,null);else{var t=n.find(function(e){return e.id==o});t?r(null,t):r("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(e,t){u.fetchRestaurants(function(e,n){e?t(e,null):t(null,results)})}},{key:"fetchRestaurantByNeighborhood",value:function(e,t){u.fetchRestaurants(function(e,n){e?t(e,null):t(null,results)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(o,r,a){u.fetchRestaurants(function(e,n){if(e)console.log("error from db"),a(e,null);else{console.log(n,"restaurant");var t=n;"all"!=o&&(t=t.filter(function(e){return e.cuisine_type==o})),"all"!=r&&(t=t.filter(function(e){return e.neighborhood==r})),a(null,t)}})}},{key:"fetchNeighborhoods",value:function(r){u.fetchRestaurants(function(e,t){if(e)r(e,null);else{var o=t.map(function(e,n){return t[n].neighborhood}),n=o.filter(function(e,n){return o.indexOf(e)==n});r(null,n)}})}},{key:"fetchCuisines",value:function(r){u.fetchRestaurants(function(e,t){if(e)r(e,null);else{var o=t.map(function(e,n){return t[n].cuisine_type}),n=o.filter(function(e,n){return o.indexOf(e)==n});r(null,n)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"/img/"+e.photograph.replace(/\.jpg$/,".webp")}},{key:"mapMarkerForRestaurant",value:function(e,n){return new google.maps.Marker({position:e.latlng,title:e.name,url:u.urlForRestaurant(e),map:n,animation:google.maps.Animation.DROP})}},{key:"onWindowResize",value:function(){var e=document.body.clientWidth,n="";return 1024<=e?n="lrg-desktop":768<=e?n="desktop":425<=e?n="mobile-l":375<=e?n="mobile-m":320<=e&&(n="mobile-s"),document.body.className="",document.body.classList.add(n),n}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/api/v1/restaurants"}}]),u}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLWhlbHBlci5qcyJdLCJuYW1lcyI6WyJyZWdpc3RlclNXIiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsInJlZ2lzdGVyIiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVTdGF0dXMiLCJldmVudCIsInN0YXR1cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25kaXRpb24iLCJvbkxpbmUiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc05hbWUiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJyZW1vdmVBdHRyaWJ1dGUiLCJEQkhlbHBlciIsImNhbGxiYWNrIiwicGF0aCIsInJlcXVlc3QiLCJSZXF1ZXN0IiwiREFUQUJBU0VfVVJMIiwibWV0aG9kIiwiaGVhZGVycyIsIkhlYWRlcnMiLCJDb250ZW50LVR5cGUiLCJmZXRjaCIsInJlc3BvbnNlIiwianNvbiIsImRhdGEiLCJlcnIiLCJpZCIsImZldGNoUmVzdGF1cmFudHMiLCJlcnJvciIsInJlc3RhdXJhbnRzIiwicmVzdGF1cmFudCIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJuZWlnaGJvcmhvb2QiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJtYXAiLCJ2IiwiaSIsInVuaXF1ZU5laWdoYm9yaG9vZHMiLCJuZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsInVuaXF1ZUN1aXNpbmVzIiwiY3Vpc2luZXMiLCJwaG90b2dyYXBoIiwicmVwbGFjZSIsIm1hcHMiLCJNYXJrZXIiLCJwb3NpdGlvbiIsImxhdGxuZyIsInRpdGxlIiwibmFtZSIsInVybCIsImFuaW1hdGlvbiIsImdvb2dsZSIsIkFuaW1hdGlvbiIsIkRST1AiLCJ3aWR0aCIsImJvZHkiLCJjbGllbnRXaWR0aCIsIm1lZGlhV2lkdGgiLCJjbGFzc0xpc3QiLCJhZGQiXSwibWFwcGluZ3MiOiI2WEFHQSxJQUFNQSxXQUFhLFdBRWIsa0JBQW1CQyxVQUx6QkEsVUFBQUMsY0FBQUMsU0FBQSxzQkFPT0MsS0FBSyxXQUNK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QyxJQUNMNUIsRUFBQSxLQUFBZ0MsK0NBSWVILEdBQ2hCLE1BQUEsd0JBQUFYLEVBQUFKLGlEQWdDd0JJLEdBQzNCLE1BQUEsUUFBZ0JBLEVBQVdnQixXQUFXQyxRQUFRLFNBQVUsd0RBdkIzQ2pCLEVBQUFRLEdBTVQsT0FMU1YsSUFBQUEsT0FBVG9CLEtBQUFDLE9BQUEsQ0FDREMsU0FBTXBCLEVBQUFxQixPQUNMQyxNQUFBdEIsRUFBQXVCLEtBQ0FDLElBQUEzQyxFQUFNa0MsaUJBQXVCUCxHQUFJQSxJQUFBQSxFQUFBaUIsVUFBakNDLE9BQUFSLEtBQUFTLFVBQUFDLGdEQUlELElBQUFDLEVBQUF4RCxTQUFBeUQsS0FBQUMsWUFUSEMsRUFBQSxHQTREQSxPQWZhLE1BQVRILEVBaENORyxFQUFBLGNBa0NzQixLQUFUSCxFQUNURyxFQUFhLFVBQ0ssS0FBVEgsRUFDVEcsRUFBYSxXQUNLLEtBQVRILEVBQ1RHLEVBQWEsV0FuQ2YsS0FBQUgsSUFDREcsRUFBQSxZQXVDQzNELFNBQVN5RCxLQUFLcEQsVUFBWSxHQUMxQkwsU0FBU3lELEtBQUtHLFVBQVVDLElBQUlGLEdBRXJCQSx1Q0FqTVAsTUFBQSIsImZpbGUiOiJkYi1oZWxwZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlZ2lzdGVyIFNlcnZpY2UgV29ya2VyLlxuICovXG5jb25zdCByZWdpc3RlclNXID0gKCkgPT4ge1xuICAvLyBUb0RvOiBBZGQgc2VydmljZSB3b3JrZXIgdG8gY2FjaGUgaW1hZ2VzLCBzdHlsZXMgYW5kIGpzXG4gIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSB7XG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zZXJ2aWNlLXdvcmtlci5qcycpXG4gICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWdpc3RyYXRpb24gY29tcGxldGUuJyk7XG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWdpc3RyYXRpb24gZmFpbHVyZS4nKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKCdTZXJ2aWNlIHdvcmtlciBub3Qgc3VwcG9ydGVkLicpO1xuICB9XG59XG5cbi8qKlxuICogVXBkYXRlIHRoZSBVc2VyIHdoZW4gdGhlIHdlYnNpdGUgaXMgb2ZmbGluZS5cbiAqICBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTmF2aWdhdG9yT25MaW5lL09ubGluZV9hbmRfb2ZmbGluZV9ldmVudHNcbiAqL1xuY29uc3QgdXBkYXRlU3RhdHVzID0gKGV2ZW50KSA9PiB7XG4gIGNvbnN0IHN0YXR1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhdHVzXCIpO1xuICBjb25zdCBjb25kaXRpb24gPSBuYXZpZ2F0b3Iub25MaW5lID8gXCJvbmxpbmVcIiA6IFwib2ZmbGluZVwiO1xuXG4gIGlmIChjb25kaXRpb24gPT09IFwib2ZmbGluZVwiKSB7XG4gICAgY29uc29sZS5sb2coY29uZGl0aW9uLCAnc3RhdHVzJyk7XG4gICAgc3RhdHVzLmNsYXNzTmFtZSA9IGNvbmRpdGlvbjtcbiAgICBzdGF0dXMuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIFwiU3RhdHVzOiBXZWJzaXRlIFwiICsgY29uZGl0aW9uKTtcbiAgICBzdGF0dXMuc2V0QXR0cmlidXRlKFwiYXJpYS1saXZlXCIsIFwiYXNzZXJ0aXZlXCIpO1xuICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PT0gXCJvbmxpbmVcIikge1xuICAgIHN0YXR1cy5jbGFzc05hbWUgPSAnJztcbiAgICBzdGF0dXMuaW5uZXJIVE1MID0gJyc7XG4gICAgc3RhdHVzLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtbGl2ZVwiKTtcbiAgfVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgdXBkYXRlU3RhdHVzKTtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgdXBkYXRlU3RhdHVzKTtcblxuXG4vKipcbiAqIENvbW1vbiBkYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zLlxuICovXG5jbGFzcyBEQkhlbHBlciB7XG5cbiAgLyoqXG4gICAqIERhdGFiYXNlIFVSTC5cbiAgICogQ2hhbmdlIHRoaXMgdG8gcmVzdGF1cmFudHMuanNvbiBmaWxlIGxvY2F0aW9uIG9uIHlvdXIgc2VydmVyLlxuICAgKi9cbiAgc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XG4gICAgY29uc3QgcG9ydCA9IDEzMzcgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxuICAgIHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9L2FwaS92MS9yZXN0YXVyYW50c2A7XG4gIH1cblxuICAvKiogaHR0cDovL2xvY2FsaG9zdDoxMzM3L2FwaS92MS9yZXN0YXVyYW50c1xuICAgKiBGZXRjaCBhbGwgcmVzdGF1cmFudHMuXG4gICAqL1xuICBzdGF0aWMgZmV0Y2hGcm9tQXBpKGNhbGxiYWNrLCBwYXRoKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGAke0RCSGVscGVyLkRBVEFCQVNFX1VSTH0ke3BhdGh9YCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfSlcbiAgICB9KTtcbiAgICBmZXRjaChyZXF1ZXN0KVxuICAgICAgLnRoZW4oXG4gICAgICAgIChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvb2tzIGxpa2UgdGhlcmUgd2FzIGEgcHJvYmxlbS4gU3RhdHVzIENvZGU6ICcgK1xuICAgICAgICAgICAgICByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEV4YW1pbmUgdGhlIHRleHQgaW4gdGhlIHJlc3BvbnNlXG4gICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaCBFcnJvciA6LVMnLCBlcnIpO1xuICAgICAgICBjYWxsYmFjayhgUmVxdWVzdCBmYWlsZWQuIFJldHVybmVkICR7ZXJyfWAsIG51bGwpO1xuICAgICAgfSk7XG5cbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxuICAgKi9cbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XG4gICAgLy8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50cy5maW5kKHIgPT4gci5pZCA9PSBpZCk7XG4gICAgICAgIGlmIChyZXN0YXVyYW50KSB7IC8vIEdvdCB0aGUgcmVzdGF1cmFudFxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuICAgICAgICB9IGVsc2UgeyAvLyBSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZVxuICAgICAgICAgIGNhbGxiYWNrKCdSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0JywgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICovXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcbiAgICAgICAgLy8gY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICovXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcbiAgICAgICAgLy8gY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSBhbmQgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAqL1xuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyb3IgZnJvbSBkYicpO1xuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXN0YXVyYW50cywgJ3Jlc3RhdXJhbnQnKTtcbiAgICAgICAgbGV0IHJlc3VsdHMgPSByZXN0YXVyYW50c1xuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG4gICAqL1xuICBzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXG4gICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXG4gICAgICAgIGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcigodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGkpXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cbiAgICovXG4gIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKVxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXG4gICAgICAgIGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxuICAgKi9cbiAgc3RhdGljIHVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xuICAgIHJldHVybiAoYC4vcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cbiAgICovXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xuICAgIHJldHVybiAoYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGgucmVwbGFjZSgvXFwuanBnJC8sIFwiLndlYnBcIil9YCk7XG4gIH1cblxuICAvKipcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxuICAgKi9cbiAgc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICBwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxuICAgICAgbWFwOiBtYXAsXG4gICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QXG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcjtcbiAgfVxuXG4gIHN0YXRpYyBvbldpbmRvd1Jlc2l6ZSgpIHtcbiAgICBsZXQgd2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuICAgIGxldCBtZWRpYVdpZHRoID0gJyc7XG5cbiAgICBpZiAod2lkdGggPj0gMTAyNCkge1xuICAgICAgbWVkaWFXaWR0aCA9ICdscmctZGVza3RvcCc7XG4gICAgfSBlbHNlIGlmICh3aWR0aCA+PSA3NjgpIHtcbiAgICAgIG1lZGlhV2lkdGggPSAnZGVza3RvcCc7XG4gICAgfSBlbHNlIGlmICh3aWR0aCA+PSA0MjUpIHtcbiAgICAgIG1lZGlhV2lkdGggPSAnbW9iaWxlLWwnO1xuICAgIH0gZWxzZSBpZiAod2lkdGggPj0gMzc1KSB7XG4gICAgICBtZWRpYVdpZHRoID0gJ21vYmlsZS1tJztcbiAgICB9IGVsc2UgaWYgKHdpZHRoID49IDMyMCkge1xuICAgICAgbWVkaWFXaWR0aCA9ICdtb2JpbGUtcyc7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc05hbWUgPSAnJztcbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQobWVkaWFXaWR0aCk7XG5cbiAgICByZXR1cm4gbWVkaWFXaWR0aDtcbiAgfVxuXG5cbn1cbiJdfQ==
