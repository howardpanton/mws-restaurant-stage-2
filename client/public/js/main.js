"use strict";var restaurants=void 0,neighborhoods=void 0,cuisines=void 0,map=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){console.log("test"),DBHelper.onWindowResize(),updateRestaurants(),fetchNeighborhoods(),fetchCuisines(),registerSW()}),window.addEventListener("resize",function(e){DBHelper.onWindowResize()},!1),window.addEventListener("loaded",function(e){var n=document.querySelectorAll(".restaurant-item"),t=0,o=!0,r=!1,s=void 0;try{for(var a,i=n.entries()[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var d=a.value,l=ImageHelper.lazyLoadImages(e.detail[t]),u=d[1].childNodes[1];d[1].removeChild(u),d[1].insertAdjacentHTML("beforeend",l),t++}}catch(e){r=!0,s=e}finally{try{!o&&i.return&&i.return()}finally{if(r)throw s}}},!1);var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,n){e?console.error(e):(self.neighborhoods=n,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,t=document.getElementById("neighborhoods-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,n){e?console.error(e):(self.cuisines=n,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,t=document.getElementById("cuisines-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},updateRestaurants=function(){console.log("running");var e=document.getElementById("cuisines-select"),n=document.getElementById("neighborhoods-select"),t=e.selectedIndex,o=n.selectedIndex,r=e[t].value,s=n[o].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,s,function(e,n){e?console.error(e,"error"):(console.log("get restaurants"),resetRestaurants(n),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,n=new CustomEvent("loaded",{detail:e}),t=document.getElementById("restaurants-list");e.forEach(function(e){t.insertAdjacentHTML("beforeend",createRestaurantHTML(e))}),addMarkersToMap(),window.setTimeout(function(){window.dispatchEvent(n)},3e3)},createRestaurantHTML=function(e){var n=e.name.replace(/\s+/g,"-").toLowerCase();return'\n    <li class="restaurant-item">\n      <div class="loading-ball">\n        <div></div>\n      </div>\n      <h3 id="name-'+n+'">'+e.name+'</h3>\n      <p id="neighborhood-'+n+'">'+e.neighborhood+'</p>\n      <p id="address-'+n+'">'+e.address+'</p>\n      <a aria-labelledby="name-'+n+" neighborhood-"+n+" address-"+n+'"\n        href="'+DBHelper.urlForRestaurant(e)+'">View Details</a>\n    </li>\n  '},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var n=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(n,"click",function(){window.location.href=n.url}),self.markers.push(n)}),google.maps.event.addListener(map,"tilesloaded",function(e){document.querySelectorAll("#map *").forEach(function(e){e.setAttribute("tabindex","-1")})},!1)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjb25zb2xlIiwibG9nIiwiREJIZWxwZXIiLCJ1cGRhdGVSZXN0YXVyYW50cyIsImZldGNoTmVpZ2hib3Job29kcyIsIndpbmRvdyIsIm9uV2luZG93UmVzaXplIiwicmVzdGF1cmFudHNJdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsInVuZGVmaW5lZCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiZW50cmllcyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJpbmRleCIsInZhbHVlIiwiaW1nIiwiSW1hZ2VIZWxwZXIiLCJsYXp5TG9hZEltYWdlcyIsImRldGFpbCIsImxvYWRpbmdCYWxsIiwiZW50cnkiLCJjaGlsZE5vZGVzIiwicmVtb3ZlQ2hpbGQiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJlcnIiLCJyZXR1cm4iLCJlcnJvciIsInNlbGYiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzZWxlY3QiLCJnZXRFbGVtZW50QnlJZCIsImZvckVhY2giLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiZmV0Y2hDdWlzaW5lcyIsImZpbGxDdWlzaW5lc0hUTUwiLCJjdWlzaW5lIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJzZWxlY3RlZEluZGV4IiwiY0luZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtIiwic2V0TWFwIiwiQ3VzdG9tRXZlbnQiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJzZXRUaW1lb3V0IiwiZGlzcGF0Y2hFdmVudCIsInVsIiwidG9Mb3dlckNhc2UiLCJzdHlsZSIsIm5hbWUiLCJhZGRyZXNzIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcmtlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsInVybCIsInB1c2giLCJnb29nbGUiLCJtYXBzIiwiZXZ0IiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsaUJBQUFBLEVBQ0ZDLG1CQUFBQSxFQURGQyxjQUFBQSxFQUFBQyxTQUFBQSxFQUFBQyxRQUVFRixHQU9GRyxTQUFTQyxpQkFBaUIsbUJBQW9CLFNBQUNDLEdBQzdDQyxRQUFRQyxJQUFJLFFBRGRKLFNBQVNDLGlCQUNQRSxvQkFDQUUscUJBQ0FDLGdCQUNBQyxlQU1GQyxPQUFPUCxpQkFBaUIsU0FBVSxTQUFDQyxHQURuQ0csU0FBQUksbUJBQ0FELEdBS0FBLE9BQU9QLGlCQUFpQixTQUFVLFNBQVVDLEdBRDVDLElBQUFRLEVBQUFWLFNBQUFXLGlCQUFBLG9CQUVRRCxFQUFBQSxFQUQyQ0UsR0FBQSxFQUFBQyxHQUFBLEVBQUFDLE9BQUFDLEVBQUEsSUFHakQsSUFBQSxJQUFBQyxFQUFBQyxFQUFBUCxFQUFBUSxVQUFBQyxPQUFBQyxjQUFBUixHQUFBSSxFQUFBQyxFQUFBSSxRQUFBQyxNQUFBVixHQUFBLEVBQUEsQ0FBQSxJQUFJVyxFQUFKUCxFQUFBUSxNQUhpREMsRUFBQUMsWUFBQUMsZUFBQXpCLEVBQUEwQixPQUFBTCxJQUFBTSxFQUFBQyxFQUFBLEdBQUFDLFdBQUEsR0FVL0NELEVBQU0sR0FBR0UsWUFBWUgsR0FWMEJDLEVBQUEsR0FBQUcsbUJBQUEsWUFBQVIsR0FLakRGLEtBTGlELE1BQUFXLEdBQUFyQixHQUFBLEVBQUFDLEVBQUFvQixFQUFBLFFBQUEsS0FBQXRCLEdBQUFLLEVBQUFrQixRQUFBbEIsRUFB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Q0UsSUFBTVUsRUFBU3BFLFNBQVNxRSx1QkFBdUJYLEVBQVkxQixLQUFLdkMsS0FoQ2xFVSxPQUFPeUQsS0FBQUEsTUFBV1UsWUFBTUYsRUFBQSxRQUFBLFdBQ3RCakUsT0FBTzBELFNBQUFBLEtBQWNoRSxFQUFyQjBFLE1BVEp2QyxLQUFBdEMsUUFBQThFLEtBQUFKLEtBK0NFSyxPQUFPQyxLQUFLN0UsTUFBTXlFLFlBQVk3RSxJQUFLLGNBQWUsU0FBU2tGLEdBL0J2RGhCLFNBQUFBLGlCQUF1QixVQUF2QkEsUUFBQUEsU0FBd0JELEdBQ3hCTSxFQUFBQSxhQUFRTixXQUFnQmtCLFVBbUN6QiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxuICBuZWlnaGJvcmhvb2RzLFxuICBjdWlzaW5lcyxcbiAgbWFwLFxuICBtYXJrZXJzID0gW107XG5cbi8qKlxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcbiAgY29uc29sZS5sb2coJ3Rlc3QnKTtcbiAgREJIZWxwZXIub25XaW5kb3dSZXNpemUoKTtcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcbiAgZmV0Y2hOZWlnaGJvcmhvb2RzKCk7XG4gIGZldGNoQ3Vpc2luZXMoKTtcbiAgcmVnaXN0ZXJTVygpO1xufSk7XG5cbi8vIExpc3RlbiBmb3Igd2lkb3cgcmVzaXplIGV2ZW50XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoZXZlbnQpID0+IHtcbiAgREJIZWxwZXIub25XaW5kb3dSZXNpemUoKTtcbn0sIGZhbHNlKTtcblxuLy8gTGlzdGVuIGZvciB0aGUgcmVzdGF1cmFudCBkYXRhIHRvIGJlIGxvYWRlZCBldmVudC5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgcmVzdGF1cmFudHNJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXN0YXVyYW50LWl0ZW0nKTtcblxuICBsZXQgaW5kZXggPSAwO1xuICAvLyBsb2FkZWQgaW1hZ2UgZmlsZXNcbiAgZm9yIChjb25zdCBlbnRyeSBvZiByZXN0YXVyYW50c0l0ZW1zLmVudHJpZXMoKSkge1xuICAgIC8vIEltYWdlIEhUTUwgaXMgY3JlYXRlZCBpbiAvaW1nLWhlbHBlci1qc1xuICAgIC8vIEFMIHRhZyBmb3IgSW1nIEVsZW1lbnQgaXMgc2V0IGluIHRoZSBsYXp5TG9hZEltYWdlcyBmdW5jdGlvblxuICAgIGNvbnN0IGltZyA9IEltYWdlSGVscGVyLmxhenlMb2FkSW1hZ2VzKGV2ZW50LmRldGFpbFtpbmRleF0pO1xuICAgIGNvbnN0IGxvYWRpbmdCYWxsID0gZW50cnlbMV0uY2hpbGROb2Rlc1sxXTtcbiAgICBlbnRyeVsxXS5yZW1vdmVDaGlsZChsb2FkaW5nQmFsbCk7XG4gICAgZW50cnlbMV0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBpbWcpO1xuICAgIGluZGV4Kys7XG4gIH1cbn0sIGZhbHNlKTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbmNvbnN0IGZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxuICovXG5jb25zdCBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xuICB9KTtcbn1cblxuLyoqXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5jb25zdCBmZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xuICBEQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxuICovXG5jb25zdCBmaWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XG5cbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcbiAgfSk7XG59XG5cbi8vIC8qKlxuLy8gICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuLy8gICovXG4vLyB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbi8vICAgbGV0IGxvYyA9IHtcbi8vICAgICBsYXQ6IDQwLjcyMjIxNixcbi8vICAgICBsbmc6IC03My45ODc1MDFcbi8vICAgfTtcbi8vICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuLy8gICAgIHpvb206IDEyLFxuLy8gICAgIGNlbnRlcjogbG9jLFxuLy8gICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuLy8gICB9KTtcbi8vICAgdXBkYXRlUmVzdGF1cmFudHMoKTtcbi8vIH1cblxuLyoqXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxuICovXG5jb25zdCB1cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcbiAgY29uc29sZS5sb2coJ3J1bm5pbmcnKTtcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcblxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLFxuICAgICAgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yLCAnZXJyb3InKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ2dldCByZXN0YXVyYW50cycpO1xuICAgICAgcmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XG4gICAgfVxuICB9KVxufVxuXG4vKipcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cbiAqL1xuY29uc3QgcmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xuICB1bC5pbm5lckhUTUwgPSAnJztcblxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXG4gIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xuICBzZWxmLm1hcmtlcnMgPSBbXTtcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XG4gIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdsb2FkZWQnLCB7IGRldGFpbDogcmVzdGF1cmFudHN9KTtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuICAgIHVsLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xuICB9KTtcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XG5cbiAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfSwgMzAwMCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cbiAqL1xuY29uc3QgY3JlYXRlUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCkgPT4ge1xuICBsZXQgc3R5bGUgPSByZXN0YXVyYW50Lm5hbWUucmVwbGFjZSgvXFxzKy9nLCAnLScpLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGxpID0gYFxuICAgIDxsaSBjbGFzcz1cInJlc3RhdXJhbnQtaXRlbVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImxvYWRpbmctYmFsbFwiPlxuICAgICAgICA8ZGl2PjwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8aDMgaWQ9XCJuYW1lLSR7c3R5bGV9XCI+JHtyZXN0YXVyYW50Lm5hbWV9PC9oMz5cbiAgICAgIDxwIGlkPVwibmVpZ2hib3Job29kLSR7c3R5bGV9XCI+JHtyZXN0YXVyYW50Lm5laWdoYm9yaG9vZH08L3A+XG4gICAgICA8cCBpZD1cImFkZHJlc3MtJHtzdHlsZX1cIj4ke3Jlc3RhdXJhbnQuYWRkcmVzc308L3A+XG4gICAgICA8YSBhcmlhLWxhYmVsbGVkYnk9XCJuYW1lLSR7c3R5bGV9IG5laWdoYm9yaG9vZC0ke3N0eWxlfSBhZGRyZXNzLSR7c3R5bGV9XCJcbiAgICAgICAgaHJlZj1cIiR7REJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX1cIj5WaWV3IERldGFpbHM8L2E+XG4gICAgPC9saT5cbiAgYDtcblxuICByZXR1cm4gbGk7XG59XG5cbi8qKlxuICogQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cbiAqL1xuY29uc3QgYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xuICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXG4gICAgfSk7XG4gICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcbiAgfSk7XG5cbiAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAndGlsZXNsb2FkZWQnLCBmdW5jdGlvbihldnQpIHtcbiAgICAgLy8gTVdTIFNsYWNrL3Jlc3RhdXJhbnQtcHJvamVjdCBoYWNrIHRvIGFkZCB0YWJpbmRlcyAtMVxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtYXAgKicpLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICBpdGVtLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCctMScpO1xuICAgIH0pO1xuICB9LCBmYWxzZSk7XG5cbn1cbiJdfQ==
